<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for gsn/GSNable.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">gsn/</a> GSNable.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/18</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/19</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity 0.6.6;
&nbsp;
import "../../node_modules/@openzeppelin/contracts/GSN/IRelayRecipient.sol";
import "./GSNRecipient.sol";
&nbsp;
&nbsp;
/**
 * @author Simon Dosch
 * @title GSNable
 * @dev enables GSN capability by implementing GSNRecipient
 * Can be set to accept ALL, NONE or add a MODULE implementing restrictions
 */
contract GSNable is GSNRecipient {
	/**
	 * @dev Emitted when a new GSN mode is set
	 */
	event GSNModeSet(gsnMode);
&nbsp;
	/**
	 * @dev Emitted when a new GSN module address is set
	 */
	event GSNModuleSet(IRelayRecipient);
&nbsp;
	/**
	 * @dev Add access control by overriding this function!
	 * should return true if sender is authorized
	 */
<span class="fstat-no" title="function not covered" >	function _isGSNController() internal virtual view returns (bool) {</span>
		this;
<span class="cstat-no" title="statement not covered" >		return true;</span>
	}
&nbsp;
	/**
	 * @dev Address of the GSN MODULE implementing IRelayRecipient
	 */
	IRelayRecipient private _gsnModule = IRelayRecipient(address(0));
&nbsp;
	/**
	 * @dev Modifier to make a function callable only when _isGSNController returns true
	 */
<span class="fstat-no" title="function not covered" >	modifier onlyGSNController() {</span>
<span class="cstat-no" title="statement not covered" >		require(_isGSNController(), "!GSN_CONTROLLER")</span>;
		_;
	}
&nbsp;
	/**
	 * @dev doc in IRelayRecipient
	 */
<span class="fstat-no" title="function not covered" >	function acceptRelayedCall(</span>
		address relay,
		address from,
		bytes calldata encodedFunction,
		uint256 transactionFee,
		uint256 gasPrice,
		uint256 gasLimit,
		uint256 nonce,
		bytes calldata approvalData,
		uint256 maxPossibleCharge
	) external override view returns (uint256, bytes memory) {
<span class="cstat-no" title="statement not covered" >		if (_gsnMode == gsnMode.ALL) {</span>
<span class="cstat-no" title="statement not covered" >			return _approveRelayedCall();</span>
		} else <span class="cstat-no" title="statement not covered" >if (_gsnMode == gsnMode.MODULE) {</span>
<span class="cstat-no" title="statement not covered" >			return</span>
				_gsnModule.acceptRelayedCall(
					relay,
					from,
					encodedFunction,
					transactionFee,
					gasPrice,
					gasLimit,
					nonce,
					approvalData,
					maxPossibleCharge
				);
		} else {
<span class="cstat-no" title="statement not covered" >			return _rejectRelayedCall(0);</span>
		}
	}
&nbsp;
	/**
	 * @dev doc in IRelayRecipient
	 */
<span class="fstat-no" title="function not covered" >	function _preRelayedCall(bytes memory context)</span>
		internal
		override
		returns (bytes32)
	{
<span class="cstat-no" title="statement not covered" >		if (_gsnMode == gsnMode.MODULE) {</span>
<span class="cstat-no" title="statement not covered" >			return _gsnModule.preRelayedCall(context);</span>
		}
	}
&nbsp;
	/**
	 * @dev doc in IRelayRecipient
	 */
<span class="fstat-no" title="function not covered" >	function _postRelayedCall(</span>
		bytes memory context,
		bool success,
		uint256 actualCharge,
		bytes32 preRetVal
	) internal override {
<span class="cstat-no" title="statement not covered" >		if (_gsnMode == gsnMode.MODULE) {</span>
<span class="cstat-no" title="statement not covered" >			return</span>
				_gsnModule.postRelayedCall(
					context,
					success,
					actualCharge,
					preRetVal
				);
		}
	}
&nbsp;
	/**
	 * @dev Sets GSN mode to either ALL, NONE or MODULE
	 * @param mode ALL, NONE or MODULE
	 */
<span class="fstat-no" title="function not covered" >	function setGSNMode(gsnMode mode) public onlyGSNController {</span>
<span class="cstat-no" title="statement not covered" >		_gsnMode = gsnMode(mode)</span>;
<span class="cstat-no" title="statement not covered" >		emit GSNModeSet(mode);</span>
	}
&nbsp;
	/**
	 * @dev Gets GSN mode
	 * @return gsnMode ALL, NONE or MODULE
	 */
<span class="fstat-no" title="function not covered" >	function getGSNMode() public view onlyGSNController returns (gsnMode) {</span>
<span class="cstat-no" title="statement not covered" >		return _gsnMode;</span>
	}
&nbsp;
	/**
	 * @dev Sets Module address for MODULE mode
	 * @param newGSNModule Address of new GSN module
	 */
<span class="fstat-no" title="function not covered" >	function setGSNModule(IRelayRecipient newGSNModule)</span>
		public
		onlyGSNController
	{
<span class="cstat-no" title="statement not covered" >		_gsnModule = newGSNModule</span>;
<span class="cstat-no" title="statement not covered" >		emit GSNModuleSet(newGSNModule);</span>
	}
&nbsp;
	/**
	 * @dev Upgrades the relay hub address
	 * @param newRelayHub Address of new relay hub
	 */
<span class="fstat-no" title="function not covered" >	function upgradeRelayHub(address newRelayHub) public onlyGSNController {</span>
<span class="cstat-no" title="statement not covered" >		_upgradeRelayHub(newRelayHub)</span>;
	}
&nbsp;
	/**
	 * @dev Withdraws GSN deposits for this contract
	 * @param amount Amount to be withdrawn
	 * @param payee Address to sned the funds to
	 */
<span class="fstat-no" title="function not covered" >	function withdrawDeposits(uint256 amount, address payable payee)</span>
		public
		onlyGSNController
	{
<span class="cstat-no" title="statement not covered" >		_withdrawDeposits(amount, payee)</span>;
	}
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Nov 01 2022 15:41:01 GMT+0100 (Central European Standard Time)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
